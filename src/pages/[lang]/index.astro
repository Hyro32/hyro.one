---
import type { GetStaticPaths } from 'astro'
import type { Project } from '../../types/types'
import { REPOS_ENDPOINT, PAGE_TITLE } from '../../types/constants'
import Layout from '../../layouts/Layout.astro'
import languages from '../../i18n/languages'
import ProjectCard from '../../components/ProjectCard.astro'

export const getStaticPaths = (() => {
  return Object.keys(languages).map((lang) => ({
    params: { lang }
  }))
}) satisfies GetStaticPaths

const { lang } = Astro.params
const title = PAGE_TITLE

const projects = await fetch(REPOS_ENDPOINT)
  .then((res) => res.json())
  .then((projects: Project[]) => projects)
---

<Layout {title} {lang}>
  <div class="flex flex-col gap-6">
    <h2 class="text-xl">Projects</h2>
    <ul class="grid grid-cols-3 gap-6">
      {projects.map((project: Project) => <ProjectCard {project} />)}
    </ul>
  </div>
</Layout>

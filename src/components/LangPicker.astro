---
import { languages } from '../i18n/ui'
import { getLangFromUrl, getSlugFromUrl } from '../i18n/utils'
import { FaLanguage } from 'react-icons/fa6'
import { RiArrowDropDownLine } from 'react-icons/ri'

const lang = getLangFromUrl(Astro.url)
const slug = getSlugFromUrl(Astro.url)
---

<div class="relative">
  <button class="flex items-center gap-2" id="lang-btn">
    <FaLanguage />
    {languages[lang]}
    <RiArrowDropDownLine />
  </button>
  <ul
    class="hidden absolute right-0 mt-2 rounded-md shadow-md bg-white ring-1 ring-black ring-opacity-5"
    id="lang-languages"
  >
    {
      Object.entries(languages).map(([lang, label]) => (
        <li class="rounded-md px-4 py-2 text-gray-700 hover:bg-gray-100 active:bg-blue-100">
          <a href={`/${lang}/${slug}`}>{label}</a>
        </li>
      ))
    }
  </ul>
</div>
<script is:inline>
  const button = document.getElementById('lang-btn')
  const list = document.getElementById('lang-languages')

  button.addEventListener('click', () => {
    list.classList.toggle('hidden')
  })
</script>

---
import { languages } from '../../i18n/ui'
import { getLangFromUrl, getSlugFromUrl } from '../../i18n/utils'
import { FaLanguage } from 'react-icons/fa6'
import { RiArrowDropDownLine } from 'react-icons/ri'

const lang = getLangFromUrl(Astro.url)
const slug = getSlugFromUrl(Astro.url)
---

<div class="lang-picker">
  <button id="lang-btn">
    <FaLanguage />
    {languages[lang]}
    <RiArrowDropDownLine />
  </button>
  <ul id="lang-languages">
    {
      Object.entries(languages).map(([lang, label]) => (
        <li class="lang-picker-item">
          <a href={`/${lang}/${slug}`}>{label}</a>
        </li>
      ))
    }
  </ul>
</div>

<style>
  .lang-picker {
    position: relative;
  }

  .lang-picker button {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }

  .lang-picker ul {
    display: none;
    position: absolute;
    right: 0;
    z-index: 20;
    margin-top: 0.5rem;
    border-radius: 0.375rem;
    width: 100%;
    list-style: none;
    padding: 0;
    border-radius: 0.375rem;
    border: 1px solid var(--sl-color-gray-4);
    background-color: var(--sl-color-gray-6);
  }

  .lang-picker-item {
    padding: 0.25rem;
    border-radius: 0.375rem;
    width: auto;
    text-align: center;
  }

  .lang-picker-item a {
    text-decoration: none;
    color: var(--sl-color-text);
  }

  .lang-picker-item:hover {
    background-color: var(--sl-color-gray-5);
  }
</style>

<script is:inline>
  const button = document.getElementById('lang-btn')
  const list = document.getElementById('lang-languages')

  button.addEventListener('click', () => {
    list.style.display = list.style.display === 'block' ? 'none' : 'block'
  })
</script>
